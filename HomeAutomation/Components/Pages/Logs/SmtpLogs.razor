@page "/logs/smtp"
@using HomeAutomation.Database
@using Microsoft.EntityFrameworkCore
@inject DefaultContext defaultContext

<MudText Typo="Typo.h2" Class="mb-5">Logs - SMTP</MudText>

<MudTable Items="@rows" Hover="true" Loading="@(rows == null)" LoadingProgressColor="Color.Info">
    <HeaderContent>
        <MudTh>Timestamp</MudTh>
        <MudTh>Device Source ID</MudTh>
        <MudTh>Message ID</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="Timestamp">@context.Timestamp</MudTd>
        <MudTd DataLabel="DeviceSourceID">@context.DeviceId</MudTd>
        <MudTd DataLabel="MessageID">@context.MessageId</MudTd>
    </RowTemplate>
</MudTable>

@code {
    private Database.Entities.MailMessageEntity[]? rows;

    protected override async Task OnInitializedAsync()
    {
        rows = await defaultContext.MailMessages.OrderByDescending(x => x.Timestamp).Take(100).ToArrayAsync();
    }
}
